<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Charts</title>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="js/header-loader.js" onload="loadHeader('Charts')"></script>
    <script>
        google.charts.load('current', { packages: ['corechart'] });
    google.charts.setOnLoadCallback(drawLocationVotesChart);
    google.charts.setOnLoadCallback(drawPhotoCategoriesChart);

    function drawLocationVotesChart() {
            const locationVotesData = new google.visualization.DataTable();

            // Define columns for the DataTable instance
            locationVotesData.addColumn('string', 'Location');
            locationVotesData.addColumn('number', 'Votes');

            // Add data to locationVotesData
            locationVotesData.addRows([
                ['Chinatown', 6],
                ['Botanic Gardens', 10],
                ['Marina Barrage', 7],
                ['Tiong Bahru', 4],
                ['Little India', 8],
            ]);

            // Create chart options
            const locationVotesBarChartOptions = {
                'title': 'Top Locations of the Week',
                'width': 'auto'
            };

            // Create bar chart
            const locationVotesBarChart = new google.visualization.BarChart(
                document.getElementById('location-votes-chart'),
            );

            locationVotesBarChart.draw(locationVotesData, locationVotesBarChartOptions);
        }

    function drawPhotoCategoriesChart() {
        fetch("/photo-categories-chart")
            .then((response) => {
                return response.json();
            })
            .then((photoCategoriesJson) => {
                const photoCategoriesData = new google.visualization.DataTable();
                photoCategoriesData.addColumn('string', 'Category Name');
                photoCategoriesData.addColumn('number', 'Photo Count');

                for (let i = 0; i < photoCategoriesJson.length; i++) {
                    let photoCategoriesRow = [];
                    const categoryName = photoCategoriesJson[i].categoryName;
                    const photoCount = photoCategoriesJson[i].photoCount;
                    photoCategoriesRow.push(categoryName, photoCount);

                    photoCategoriesData.addRow(photoCategoriesRow);
                }

                const photoCategoriesChartOptions = {
                    'title': 'Number of Photos According to Categories',
                    'height': 'auto',
                    'width': 'auto'
                };

                var bookChart = new google.visualization.BarChart(document.getElementById('photo-categories-chart'));
                bookChart.draw(photoCategoriesData, photoCategoriesChartOptions);
            })
    }
    </script>
    <link rel="stylesheet" href="/css/charts-page.css" />
</head>
<body>
    <div class="text-center page-header">
    <h1 class="display-4">Charts</h1>
    <p class="font-weight-lighter">Some charts.</p>
    </div>
    <div id="content">
        <div id="location-votes-chart"></div>
        <div id="photo-categories-chart"></div>
    </div>
</body>
</html>